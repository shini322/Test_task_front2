(()=>{"use strict";const n=async()=>await fetch("products.json").then((n=>n.json()));document.addEventListener("DOMContentLoaded",(()=>{const s=(s,t,e="За м. кв.")=>{const c=s.querySelector(".goldPrice"),a=s.querySelector(".retailPrice");n().then((n=>{n.forEach((n=>{if(n.productId===t)switch(e){case"За м. кв.":c.textContent=n.priceGoldAlt,a.textContent=n.priceRetailAlt;break;case"За упаковку":c.textContent=n.priceGold,a.textContent=n.priceRetail}}))}))};(s=>{const t=document.querySelector("#products_section");n().then((n=>{n.map((n=>{const{productId:s,code:e,title:c,primaryImageUrl:a,assocProducts:i,unit:r,unitFull:l,unitAlt:p,unitRatioAlt:d,isActive:o,priceGoldAlt:u,priceRetailAlt:v}=n,_=a.toLowerCase().split(""),g="упаковка"===l?`<span class="ng-binding">Продается упаковками:</span>\n                     <span class="unit--infoInn">1 ${r} = ${d} ${p} </span>\n                     `:"комплект"===l?'<span class="ng-binding">Продается в комплекте</span>':'<span class="ng-binding">Продается поштучно</span>',w=`\n                <div class="products_page pg_0" data-product-id=${s}>\n                    <div class="product product_horizontal">                                \n                        <span class="product_code">Код: ${e}</span>\n                        <div class="product_status_tooltip_container">\n                            <span class="product_status">${o?"В наличии":"Нет в наличии"}</span>\n                        </div>                                \n                        <div class="product_photo">\n                            <a href="#" class="url--link product__link">\n                                <img src="${_.slice(0,-4).concat(["_220x220_1"].concat(_.slice(-4))).join("")}">\n                            </a>                                    \n                        </div>\n                        <div class="product_description">\n                            <a href="#" class="product__link">${c}</a>\n                        </div>\n                        <div class="product_tags hidden-sm">\n                            <p>Могут понадобиться:</p>\n                            ${i.split(";").filter((n=>n)).map((n=>{if(n)return`<a href="#" class="url--link">${n.trim()}</a>`})).join(", ")}\n                        </div>\n                        <div class="product_units">\n                            <div class="unit--wrapper">\n                                <div class="unit--select unit--active">\n                                    <p class="ng-binding">За м. кв.</p>\n                                </div>\n                                <div class="unit--select">\n                                    <p class="ng-binding">За упаковку</p>\n                                </div>\n                            </div>\n                        </div>\n                        <p class="product_price_club_card">\n                            <span class="product_price_club_card_text">По карте<br>клуба</span>\n                            <span class="goldPrice">${u}</span>\n                            <span class="rouble__i black__i">\n                                <svg version="1.0" id="rouble__b" xmlns="http://www.w3.org/2000/svg" x="0" y="0" width="30px" height="22px" viewBox="0 0 50 50" enable-background="new 0 0 50 50" xml:space="preserve">\n                                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#rouble_black"></use>\n                                </svg>\n                                </span>\n                        </p>\n                        <p class="product_price_default">\n                            <span class="retailPrice">${v}</span>\n                            <span class="rouble__i black__i">\n                                <svg version="1.0" id="rouble__g" xmlns="http://www.w3.org/2000/svg" x="0" y="0" width="30px" height="22px" viewBox="0 0 50 50" enable-background="new 0 0 50 50" xml:space="preserve">\n                                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#rouble_gray"></use>\n                                </svg>\n                                </span>\n                        </p>\n                        <div class="product_price_points">\n                            <p class="ng-binding">Можно купить за ${u} балла</p>\n                        </div>\n                        <div class="list--unit-padd"></div>\n                        <div class="list--unit-desc">\n                            <div class="unit--info">\n                                <div class="unit--desc-i"></div>\n                                <div class="unit--desc-t">\n                                    <p>\n                                        ${g}\n                                    </p>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="product__wrapper">\n                            <div class="product_count_wrapper">\n                                <div class="stepper">\n                                    <input class="product__count stepper-input" type="text" value="1">\n                                    <span class="stepper-arrow up"></span>\n                                    <span class="stepper-arrow down"></span>                                            \n                                </div>\n                            </div>\n                            <span class="btn btn_cart" data-url="/cart/" data-product-id="9bf0afd7-5190-11e5-b9a9-00259036a192">\n                                <svg class="ic ic_cart">\n                                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#cart"></use>\n                                </svg>\n                                <span class="ng-binding" data-product-id=${s}>В корзину</span>\n                            </span>\n                        </div>\n                    </div>\n                </div>\n            `;t.insertAdjacentHTML("afterbegin",w)})),s()}))})((()=>{document.querySelectorAll(".products_page").forEach((n=>{s(n,n.dataset.productId),n.querySelector(".stepper").addEventListener("click",(n=>(n=>{const s=n.target,t=s.closest(".stepper").querySelector(".product__count"),e=s.closest(".up"),c=s.closest(".down");e?t.value=+t.value+1:c&&(t.value>1?t.value=+t.value-1:t.value=1)})(n))),n.querySelector(".unit--wrapper").addEventListener("click",(n=>(n=>{const t=n.target,e=t.closest(".products_page"),c=t.closest(".unit--wrapper"),a=t.closest(".unit--select"),i=c.querySelectorAll(".unit--select");if(a)switch(i.forEach((n=>n.classList.remove("unit--active"))),a.classList.add("unit--active"),a.querySelector(".ng-binding").textContent){case"За м. кв.":s(e,e.dataset.productId,"За м. кв.");break;case"За упаковку":s(e,e.dataset.productId,"За упаковку")}})(n)))}))}))}))})();